<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Thêm Sinh Viên</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

  <div class="container mt-5">
    <div class="card shadow-lg">
      <div class="card-header bg-primary text-white">
        <h4 class="mb-0">Thêm Sinh Viên</h4>
      </div>
      <div class="card-body">
        <form id="studentForm">
          <!-- THÔNG TIN CÁ NHÂN -->
          <h5 class="text-primary">Thông tin cá nhân</h5>
          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Họ và đệm</label>
              <input type="text" name="first_name" class="form-control" placeholder="VD: Hoàng Minh">
            </div>
            <div class="col-md-4">
              <label class="form-label">Tên</label>
              <input type="text" name="last_name" class="form-control" placeholder="VD: Quân">
            </div>
            <div class="col-md-4">
              <label class="form-label">Số điện thoại</label>
              <input type="text" name="phone" class="form-control" placeholder="VD: 0987654321">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Ngày sinh</label>
              <input type="date" name="dob" class="form-control">
            </div>
            <div class="col-md-4">
              <label class="form-label">Giới tính</label>
              <select name="gender" class="form-select">
                <option value="">-- Chọn --</option>
                <option value="Nam">Nam</option>
                <option value="Nữ">Nữ</option>
                <option value="Khác">Khác</option>
              </select>
            </div>
          </div>

          <!-- THÔNG TIN ĐÀO TẠO & QUẢN LÝ -->
          <h5 class="text-primary">Thông tin đào tạo & quản lý</h5>
          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Lớp</label>
              <input type="text" name="class_name" class="form-control" placeholder="VD: K17-CNTT_4">
            </div>
            <div class="col-md-4">
              <label class="form-label">Khóa đào tạo</label>
              <input type="text" name="training_program" class="form-control" placeholder="VD: DH_K17.40">
            </div>
            <div class="col-md-4">
              <label class="form-label">Niên khóa</label>
              <input type="text" name="course_years" class="form-control" placeholder="VD: 2023-2027">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Hệ đào tạo</label>
              <select name="education_type" class="form-select">
                <option value="">-- Chọn --</option>
                <option value="Đại học chính quy">Đại học chính quy</option>
                <option value="Liên thông">Liên thông</option>
                <option value="Cao đẳng">Cao đẳng</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Khoa quản lý</label>
              <input type="text" name="faculty" class="form-control" placeholder="VD: Khoa Công nghệ Thông tin">
            </div>
            <div class="col-md-4">
              <label class="form-label">Ngành</label>
              <input type="text" name="major" class="form-control" placeholder="VD: Công nghệ thông tin">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Trạng thái</label>
              <select name="status" class="form-select">
                <option value="Đang học">Đang học</option>
                <option value="Bảo lưu">Bảo lưu</option>
                <option value="Đã tốt nghiệp">Đã tốt nghiệp</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Chức vụ</label>
              <input type="text" name="position" class="form-control" placeholder="VD: Sinh viên">
            </div>
            <div class="col-md-4">
              <label class="form-label">Ảnh đại diện</label>
              <input type="file" name="avatar" class="form-control">
            </div>
          </div>

          <!-- NÚT -->
          <div class="d-flex justify-content-end">
            <button type="reset" class="btn btn-secondary me-2">Làm mới</button>
            <button type="submit" class="btn btn-primary">Lưu sinh viên</button>
          </div>
        </form>
      </div>
    </div>
  </div>

</body>

<script>
  document.getElementById("studentForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    const studentData = {
      first_name: formData.get("first_name"),
      last_name: formData.get("last_name"),
      phone: formData.get("phone"),
      dob: formData.get("dob"),
      gender: formData.get("gender"),
      class_name: formData.get("class_name"),
      training_program: formData.get("training_program"),
      course_years: formData.get("course_years"),
      education_type: formData.get("education_type"),
      faculty: formData.get("faculty"),
      major: formData.get("major"),
      status: formData.get("status"),
      position: formData.get("position"),
      // avatar xử lý upload riêng
    };

    try {
      const response = await fetch("http://localhost:8000/api/students", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(studentData),
      });

      if (!response.ok) {
        throw new Error("Lỗi khi thêm sinh viên");
      }

      const data = await response.json();
      alert("Thêm sinh viên thành công! Mã SV: " + data.student_code);
      form.reset();
    } catch (err) {
      console.error(err);
      alert("Có lỗi xảy ra khi lưu sinh viên");
    }
  });
</script>

</html>
